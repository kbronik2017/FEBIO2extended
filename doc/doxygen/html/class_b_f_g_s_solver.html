<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>FEBio: BFGSSolver Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="febio_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">FEBio
   &#160;<span id="projectnumber">2.0</span>
   </div>
   <div id="projectbrief">Finite Elements for Biomechanics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('class_b_f_g_s_solver.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="class_b_f_g_s_solver-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">BFGSSolver Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="_b_f_g_s_solver_8h_source.html">BFGSSolver.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for BFGSSolver:</div>
<div class="dyncontent">
<div class="center"><img src="class_b_f_g_s_solver__coll__graph.png" border="0" usemap="#_b_f_g_s_solver_coll__map" alt="Collaboration graph"/></div>
<map name="_b_f_g_s_solver_coll__map" id="_b_f_g_s_solver_coll__map">
<area shape="rect" id="node2" href="classmatrix.html" title="General purpose matrix class. " alt="" coords="459,206,524,237"/><area shape="rect" id="node4" href="class_f_e_solver.html" title="This is the base class for all FE solvers. " alt="" coords="177,206,265,237"/><area shape="rect" id="node12" href="class_f_e_core_1_1_f_e_analysis.html" title="Base class for finite element analysis. " alt="" coords="5,323,176,354"/><area shape="rect" id="node6" href="class_f_e_core_base.html" title="FECoreBase" alt="" coords="43,89,159,119"/><area shape="rect" id="node8" href="class_f_e_param_container.html" title="Base class for classes that wish to support parameter lists. " alt="" coords="20,6,183,37"/><area shape="rect" id="node10" href="class_f_e_model.html" title="FEModel" alt="" coords="141,422,227,453"/><area shape="rect" id="node17" href="class_f_e_mesh.html" title="Defines a finite element mesh. " alt="" coords="597,323,680,354"/><area shape="rect" id="node19" href="struct_f_e___b_o_u_n_d_i_n_g___b_o_x.html" title="FE_BOUNDING_BOX" alt="" coords="549,206,728,237"/><area shape="rect" id="node21" href="classvec3d.html" title="vec3d" alt="" coords="606,89,671,119"/><area shape="rect" id="node23" href="class_f_e_node_elem_list.html" title="FENodeElemList" alt="" coords="753,206,895,237"/><area shape="rect" id="node25" href="class_timer.html" title="This class implements a simple timer. " alt="" coords="190,89,252,119"/><area shape="rect" id="node27" href="class_linear_solver.html" title="base class for the linear solver classes " alt="" coords="315,206,428,237"/><area shape="rect" id="node29" href="class_sparse_matrix.html" title="Base class for sparse matrices. " alt="" coords="313,89,431,119"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a6cb8f87c53b2160d3fba4f2e1d12a163"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6cb8f87c53b2160d3fba4f2e1d12a163"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_b_f_g_s_solver.html#a6cb8f87c53b2160d3fba4f2e1d12a163">BFGSSolver</a> ()</td></tr>
<tr class="memdesc:a6cb8f87c53b2160d3fba4f2e1d12a163"><td class="mdescLeft">&#160;</td><td class="mdescRight">constructor <br /></td></tr>
<tr class="separator:a6cb8f87c53b2160d3fba4f2e1d12a163"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bfeed31bc963ccd388883fadb41cd91"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1bfeed31bc963ccd388883fadb41cd91"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_b_f_g_s_solver.html#a1bfeed31bc963ccd388883fadb41cd91">Init</a> (int neq, <a class="el" href="class_f_e_solver.html">FESolver</a> *pNLS, <a class="el" href="class_linear_solver.html">LinearSolver</a> *pls)</td></tr>
<tr class="memdesc:a1bfeed31bc963ccd388883fadb41cd91"><td class="mdescLeft">&#160;</td><td class="mdescRight">New initialization method. <br /></td></tr>
<tr class="separator:a1bfeed31bc963ccd388883fadb41cd91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08b50f45a3977743e6bb2a8cd831a8fe"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_b_f_g_s_solver.html#a08b50f45a3977743e6bb2a8cd831a8fe">Update</a> (double s, vector&lt; double &gt; &amp;ui, vector&lt; double &gt; &amp;R0, vector&lt; double &gt; &amp;R1)</td></tr>
<tr class="memdesc:a08b50f45a3977743e6bb2a8cd831a8fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">perform a BFGS udpate  <a href="#a08b50f45a3977743e6bb2a8cd831a8fe">More...</a><br /></td></tr>
<tr class="separator:a08b50f45a3977743e6bb2a8cd831a8fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72482e88f9d1d4160bfa0c5ff53dd6d8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a72482e88f9d1d4160bfa0c5ff53dd6d8"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_b_f_g_s_solver.html#a72482e88f9d1d4160bfa0c5ff53dd6d8">SolveEquations</a> (vector&lt; double &gt; &amp;x, vector&lt; double &gt; &amp;b)</td></tr>
<tr class="memdesc:a72482e88f9d1d4160bfa0c5ff53dd6d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">solve the equations <br /></td></tr>
<tr class="separator:a72482e88f9d1d4160bfa0c5ff53dd6d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f09d78cb0693d2852dfefcaa6a24d80"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_b_f_g_s_solver.html#a2f09d78cb0693d2852dfefcaa6a24d80">LineSearch</a> (double s)</td></tr>
<tr class="memdesc:a2f09d78cb0693d2852dfefcaa6a24d80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs a linesearch.  <a href="#a2f09d78cb0693d2852dfefcaa6a24d80">More...</a><br /></td></tr>
<tr class="separator:a2f09d78cb0693d2852dfefcaa6a24d80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2085b9e9ec399bd91d872c70b04b0c68"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2085b9e9ec399bd91d872c70b04b0c68"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_b_f_g_s_solver.html#a2085b9e9ec399bd91d872c70b04b0c68">LineSearchCG</a> (double s)</td></tr>
<tr class="memdesc:a2085b9e9ec399bd91d872c70b04b0c68"><td class="mdescLeft">&#160;</td><td class="mdescRight">modified linesearch for Hager-Zhang solver <br /></td></tr>
<tr class="separator:a2085b9e9ec399bd91d872c70b04b0c68"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a14e757f25e81242d7f125fdf8ef5b66f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a14e757f25e81242d7f125fdf8ef5b66f"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_b_f_g_s_solver.html#a14e757f25e81242d7f125fdf8ef5b66f">m_maxups</a></td></tr>
<tr class="memdesc:a14e757f25e81242d7f125fdf8ef5b66f"><td class="mdescLeft">&#160;</td><td class="mdescRight">max nr of QN iters permitted between stiffness reformations <br /></td></tr>
<tr class="separator:a14e757f25e81242d7f125fdf8ef5b66f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16ac9e33a5ee9f0e8183ee828750cfc8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a16ac9e33a5ee9f0e8183ee828750cfc8"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_b_f_g_s_solver.html#a16ac9e33a5ee9f0e8183ee828750cfc8">m_maxref</a></td></tr>
<tr class="memdesc:a16ac9e33a5ee9f0e8183ee828750cfc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">max nr of reformations per time step <br /></td></tr>
<tr class="separator:a16ac9e33a5ee9f0e8183ee828750cfc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16f519decb9ef86bf6559a8f125dabbc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a16f519decb9ef86bf6559a8f125dabbc"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_b_f_g_s_solver.html#a16f519decb9ef86bf6559a8f125dabbc">m_cmax</a></td></tr>
<tr class="memdesc:a16f519decb9ef86bf6559a8f125dabbc"><td class="mdescLeft">&#160;</td><td class="mdescRight">maximum value for the condition number <br /></td></tr>
<tr class="separator:a16f519decb9ef86bf6559a8f125dabbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26d815792c6bf9c43bbe541c75d11237"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a26d815792c6bf9c43bbe541c75d11237"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_b_f_g_s_solver.html#a26d815792c6bf9c43bbe541c75d11237">m_LSmin</a></td></tr>
<tr class="memdesc:a26d815792c6bf9c43bbe541c75d11237"><td class="mdescLeft">&#160;</td><td class="mdescRight">minimum line search step <br /></td></tr>
<tr class="separator:a26d815792c6bf9c43bbe541c75d11237"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa56234d39670a80054b4d70b1e6a811a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa56234d39670a80054b4d70b1e6a811a"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_b_f_g_s_solver.html#aa56234d39670a80054b4d70b1e6a811a">m_LStol</a></td></tr>
<tr class="memdesc:aa56234d39670a80054b4d70b1e6a811a"><td class="mdescLeft">&#160;</td><td class="mdescRight">line search tolerance <br /></td></tr>
<tr class="separator:aa56234d39670a80054b4d70b1e6a811a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f940801fc7e45b8e51911821c69f4e5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0f940801fc7e45b8e51911821c69f4e5"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_b_f_g_s_solver.html#a0f940801fc7e45b8e51911821c69f4e5">m_LSiter</a></td></tr>
<tr class="memdesc:a0f940801fc7e45b8e51911821c69f4e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">max nr of line search iterations <br /></td></tr>
<tr class="separator:a0f940801fc7e45b8e51911821c69f4e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f1744fbc21d87caa725743c2fad9879"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5f1744fbc21d87caa725743c2fad9879"></a>
<a class="el" href="class_linear_solver.html">LinearSolver</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_b_f_g_s_solver.html#a5f1744fbc21d87caa725743c2fad9879">m_plinsolve</a></td></tr>
<tr class="memdesc:a5f1744fbc21d87caa725743c2fad9879"><td class="mdescLeft">&#160;</td><td class="mdescRight">pointer to linear solver <br /></td></tr>
<tr class="separator:a5f1744fbc21d87caa725743c2fad9879"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c9afedf5c153b693de660f0634e0d0f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2c9afedf5c153b693de660f0634e0d0f"></a>
<a class="el" href="class_f_e_solver.html">FESolver</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_b_f_g_s_solver.html#a2c9afedf5c153b693de660f0634e0d0f">m_pNLS</a></td></tr>
<tr class="memdesc:a2c9afedf5c153b693de660f0634e0d0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">pointer to nonlinear system to solve <br /></td></tr>
<tr class="separator:a2c9afedf5c153b693de660f0634e0d0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a0ab0566935c20b80339ef5da65f9ef"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4a0ab0566935c20b80339ef5da65f9ef"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_b_f_g_s_solver.html#a4a0ab0566935c20b80339ef5da65f9ef">m_neq</a></td></tr>
<tr class="memdesc:a4a0ab0566935c20b80339ef5da65f9ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of equations <br /></td></tr>
<tr class="separator:a4a0ab0566935c20b80339ef5da65f9ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27e555b34f8586f25d566b9f6f19db87"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a27e555b34f8586f25d566b9f6f19db87"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_b_f_g_s_solver.html#a27e555b34f8586f25d566b9f6f19db87">m_nups</a></td></tr>
<tr class="memdesc:a27e555b34f8586f25d566b9f6f19db87"><td class="mdescLeft">&#160;</td><td class="mdescRight">nr of stiffness updates <br /></td></tr>
<tr class="separator:a27e555b34f8586f25d566b9f6f19db87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af95c9420dcd5d6a82435590644ec4b50"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af95c9420dcd5d6a82435590644ec4b50"></a>
vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_b_f_g_s_solver.html#af95c9420dcd5d6a82435590644ec4b50">m_ui</a></td></tr>
<tr class="memdesc:af95c9420dcd5d6a82435590644ec4b50"><td class="mdescLeft">&#160;</td><td class="mdescRight">displacement increment vector <br /></td></tr>
<tr class="separator:af95c9420dcd5d6a82435590644ec4b50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a243ff66f8e12039ea0777f88d18bbe51"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a243ff66f8e12039ea0777f88d18bbe51"></a>
vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_b_f_g_s_solver.html#a243ff66f8e12039ea0777f88d18bbe51">m_R0</a></td></tr>
<tr class="memdesc:a243ff66f8e12039ea0777f88d18bbe51"><td class="mdescLeft">&#160;</td><td class="mdescRight">residual at iteration i-1 <br /></td></tr>
<tr class="separator:a243ff66f8e12039ea0777f88d18bbe51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a707b2534c3ec8e3ad1b45b6c1417e943"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a707b2534c3ec8e3ad1b45b6c1417e943"></a>
vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_b_f_g_s_solver.html#a707b2534c3ec8e3ad1b45b6c1417e943">m_R1</a></td></tr>
<tr class="memdesc:a707b2534c3ec8e3ad1b45b6c1417e943"><td class="mdescLeft">&#160;</td><td class="mdescRight">residual at iteration i <br /></td></tr>
<tr class="separator:a707b2534c3ec8e3ad1b45b6c1417e943"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9567cd74d38b4e27a75367aed636d67"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae9567cd74d38b4e27a75367aed636d67"></a>
<a class="el" href="classmatrix.html">matrix</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_b_f_g_s_solver.html#ae9567cd74d38b4e27a75367aed636d67">m_V</a></td></tr>
<tr class="memdesc:ae9567cd74d38b4e27a75367aed636d67"><td class="mdescLeft">&#160;</td><td class="mdescRight">BFGS update vector. <br /></td></tr>
<tr class="separator:ae9567cd74d38b4e27a75367aed636d67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a489f74d6a2524405665a9059622e8f90"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a489f74d6a2524405665a9059622e8f90"></a>
<a class="el" href="classmatrix.html">matrix</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_b_f_g_s_solver.html#a489f74d6a2524405665a9059622e8f90">m_W</a></td></tr>
<tr class="memdesc:a489f74d6a2524405665a9059622e8f90"><td class="mdescLeft">&#160;</td><td class="mdescRight">BFGS update vector. <br /></td></tr>
<tr class="separator:a489f74d6a2524405665a9059622e8f90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a39e7dcaea8cb6f5d9969e1d8dc7a89"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6a39e7dcaea8cb6f5d9969e1d8dc7a89"></a>
vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>m_D</b></td></tr>
<tr class="separator:a6a39e7dcaea8cb6f5d9969e1d8dc7a89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30c8472ef2dfff8c4a49546de0680fd3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a30c8472ef2dfff8c4a49546de0680fd3"></a>
vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>m_G</b></td></tr>
<tr class="separator:a30c8472ef2dfff8c4a49546de0680fd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa122c80b460936a7076d2a9f68c5472"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aaa122c80b460936a7076d2a9f68c5472"></a>
vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_b_f_g_s_solver.html#aaa122c80b460936a7076d2a9f68c5472">m_H</a></td></tr>
<tr class="memdesc:aaa122c80b460936a7076d2a9f68c5472"><td class="mdescLeft">&#160;</td><td class="mdescRight">temp vectors for calculating BFGS update vectors <br /></td></tr>
<tr class="separator:aaa122c80b460936a7076d2a9f68c5472"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The <a class="el" href="class_b_f_g_s_solver.html">BFGSSolver</a> solves a nonlinear system of equations using the BFGS method. It depends on the NonLinearSystem to evaluate the function and its jacobian. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a2f09d78cb0693d2852dfefcaa6a24d80"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double BFGSSolver::LineSearch </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs a linesearch. </p>
<p>Performs a linesearch on a NR iteration The description of this method can be found in: "Nonlinear Continuum Mechanics for Finite Element Analysis", Bonet &amp; Wood. </p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000062">Todo:</a></b></dt><dd>Find a different way to update the deformation based on the ls. For instance, define a di so that ui = s*di. Also, define the position of the nodes at the previous iteration. </dd></dl>

</div>
</div>
<a class="anchor" id="a08b50f45a3977743e6bb2a8cd831a8fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BFGSSolver::Update </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>ui</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>R0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>R1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>perform a BFGS udpate </p>
<p>This function performs a BFGS stiffness update. The last line search step is input to this function. This function performs the update assuming the stiffness matrix is positive definite. In the case that this is not the case the function returns false. The function also returns false if the condition number is too big. A too big condition number might be an indication of an ill-conditioned matrix and the update should not be performed. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>S:/tmp/FEBio2/FECore/<a class="el" href="_b_f_g_s_solver_8h_source.html">BFGSSolver.h</a></li>
<li>S:/tmp/FEBio2/FECore/BFGSSolver.cpp</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="class_b_f_g_s_solver.html">BFGSSolver</a></li>
    <li class="footer">Generated on Mon May 19 2014 13:39:34 for FEBio by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
